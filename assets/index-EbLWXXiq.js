import{r as e,a as s,B as a,d as n,e as t}from"./react-vendor-CZl6HgZT.js";import{R as i}from"./analytics-D9ZmndPr.js";import{L as o,M as r,T as l,a as c,P as d,u as m}from"./map-vendor-B251Zigf.js";import{c as u}from"./supabase-vendor-DW471Bpr.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&s(e)})).observe(document,{childList:!0,subtree:!0})}function s(e){if(e.ep)return;e.ep=!0;const s=function(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?s.credentials="include":"anonymous"===e.crossOrigin?s.credentials="omit":s.credentials="same-origin",s}(e);fetch(e.href,s)}}();var h={exports:{}},p={},g=e,x=Symbol.for("react.element"),j=Symbol.for("react.fragment"),b=Object.prototype.hasOwnProperty,f=g.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,y={key:!0,ref:!0,__self:!0,__source:!0};function v(e,s,a){var n,t={},i=null,o=null;for(n in void 0!==a&&(i=""+a),void 0!==s.key&&(i=""+s.key),void 0!==s.ref&&(o=s.ref),s)b.call(s,n)&&!y.hasOwnProperty(n)&&(t[n]=s[n]);if(e&&e.defaultProps)for(n in s=e.defaultProps)void 0===t[n]&&(t[n]=s[n]);return{$$typeof:x,type:e,key:i,ref:o,props:t,_owner:f.current}}p.Fragment=j,p.jsx=v,p.jsxs=v,h.exports=p;var N,w=h.exports,k=s;N=k.createRoot,k.hydrateRoot;const S=o.icon({iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",iconRetinaUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),C=o.divIcon({className:"user-location-marker",html:'<div class="user-location-dot"></div><div class="user-location-pulse"></div>',iconSize:[20,20],iconAnchor:[10,10]}),$=(e,s,a)=>/iPad|iPhone|iPod/.test(navigator.userAgent)?`maps://maps.apple.com/?q=${encodeURIComponent(e)}&ll=${s},${a}`:`https://www.google.com/maps/search/?api=1&query=${s},${a}`;function M({center:s,zoom:a}){const n=m();return e.useEffect((()=>{n.setView(s,a)}),[s,a,n]),null}function E({center:e,zoom:s,businesses:a,onBusinessClick:n}){return a&&0!==a.length?w.jsx("div",{className:"map-container",children:w.jsxs(r,{center:e,zoom:s,style:{height:"100%",width:"100%"},attributionControl:!1,children:[w.jsx(M,{center:e,zoom:s}),w.jsx(l,{url:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",maxZoom:19}),w.jsx(c,{position:e,icon:C,children:w.jsx(d,{children:"Your approximate location"})}),a.map((e=>w.jsx(c,{position:[e.latitude,e.longitude],icon:S,children:w.jsx(d,{children:w.jsxs("div",{className:"map-popup",children:[w.jsx("h3",{children:e.name}),w.jsx("p",{className:"popup-category",children:e.category}),w.jsx("a",{href:$(e.location,e.latitude,e.longitude),className:"popup-address",target:"_blank",rel:"noopener noreferrer",children:e.location}),w.jsx("button",{className:"popup-details-btn",onClick:s=>{s.preventDefault(),n(e)},children:"View Details"})]})})},e.id)))]})}):w.jsx("div",{className:"map-container",children:w.jsxs(r,{center:e,zoom:s,style:{height:"100%",width:"100%"},attributionControl:!1,children:[w.jsx(M,{center:e,zoom:s}),w.jsx(l,{url:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",maxZoom:19}),w.jsx(c,{position:e,icon:C,children:w.jsx(d,{children:"Your approximate location"})})]})})}function P({businesses:e,onBusinessClick:s}){if(!e||0===e.length)return null;const a=e.reduce(((e,s)=>(e[s.category]||(e[s.category]=[]),e[s.category].push(s),e)),{}),n=Object.keys(a).sort();return w.jsx("div",{className:"business-sections",children:n.map((e=>w.jsxs("div",{className:"business-section",children:[w.jsx("h2",{className:"category-title",children:e}),w.jsx("div",{className:"business-grid",children:a[e].map((e=>w.jsxs("div",{className:"business-card",children:[w.jsx("img",{src:e.image_url||"https://via.placeholder.com/400x200?text=No+Image",alt:e.name,className:"business-image",onClick:()=>s(e)}),w.jsxs("div",{className:"business-info",children:[w.jsx("h3",{onClick:()=>s(e),children:e.name}),w.jsx("a",{href:$(e.location,e.latitude,e.longitude),className:"business-address",target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),children:e.location}),w.jsx("button",{className:"view-details-btn",onClick:()=>s(e),children:"View Details"})]})]},e.id)))})]},e)))})}function I({business:e,onClose:s}){return e?w.jsx("div",{className:"modal-overlay",onClick:s,children:w.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[w.jsx("button",{className:"modal-close",onClick:s,children:"Ã—"}),e.image_url&&w.jsx("img",{src:e.image_url,alt:e.name,className:"modal-image"}),w.jsxs("div",{className:"modal-details",children:[w.jsx("h2",{children:e.name}),w.jsx("div",{className:"category-badge",children:e.category}),e.description&&w.jsx("p",{className:"description",children:e.description}),w.jsxs("div",{className:"info-section",children:[w.jsx("h3",{children:"Location & Contact"}),w.jsxs("div",{className:"info-grid",children:[w.jsxs("div",{className:"info-item",children:[w.jsx("strong",{children:"Address"}),w.jsx("p",{children:w.jsx("a",{href:$(e.location,e.latitude,e.longitude),className:"contact-link",target:"_blank",rel:"noopener noreferrer",children:e.location})})]}),e.phone&&w.jsxs("div",{className:"info-item",children:[w.jsx("strong",{children:"Phone"}),w.jsx("p",{children:w.jsx("a",{href:`tel:${e.phone}`,className:"contact-link",children:e.phone})})]}),e.email&&w.jsxs("div",{className:"info-item",children:[w.jsx("strong",{children:"Email"}),w.jsx("p",{children:w.jsx("a",{href:`mailto:${e.email}`,className:"contact-link",children:e.email})})]}),e.website&&w.jsxs("div",{className:"info-item",children:[w.jsx("strong",{children:"Website"}),w.jsx("p",{children:w.jsx("a",{href:e.website,target:"_blank",rel:"noopener noreferrer",className:"contact-link",children:"Visit Website"})})]})]})]}),e.hours&&w.jsxs("div",{className:"info-section",children:[w.jsx("h3",{children:"Business Hours"}),w.jsx("p",{className:"hours",children:e.hours})]})]})]})}):null}function F({onSearch:s,onBusinessSearch:a,error:n,defaultLocation:t}){const[i,o]=e.useState(""),[r,l]=e.useState("location");return w.jsxs("div",{className:"search-container",children:[w.jsxs("form",{onSubmit:e=>{e.preventDefault(),"location"===r?s(i):a(i)},children:[w.jsxs("div",{className:"search-type-toggle",children:[w.jsx("button",{type:"button",className:"toggle-btn "+("location"===r?"active":""),onClick:()=>l("location"),children:"Search by Location"}),w.jsx("button",{type:"button",className:"toggle-btn "+("business"===r?"active":""),onClick:()=>l("business"),children:"Search Businesses"})]}),w.jsxs("div",{className:"search-input-container",children:[w.jsx("input",{type:"text",value:i,onChange:e=>o(e.target.value),placeholder:"location"===r?"Enter ZIP code or location...":"Search business name, category...",className:"search-input"}),w.jsx("button",{type:"submit",className:"search-button",children:"Search"})]})]}),n&&w.jsx("p",{className:"error-message",children:n})]})}function L({onFilterChange:s}){const[a,n]=e.useState("");return w.jsx("div",{className:"filter-section",children:w.jsx("div",{className:"filter-container",children:w.jsx("div",{className:"select-wrapper",children:w.jsxs("select",{value:a,onChange:e=>{const a=e.target.value;n(a),s(a?[a]:[])},className:"filter-select",children:[w.jsx("option",{value:"",children:"All Categories"}),["Food","Hair Care","Retail","Professional Services","Home Services","Technology"].map((e=>w.jsx("option",{value:e,children:e},e)))]})})})})}const U=u("https://eycvraxrpxkqbdmromgb.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImV5Y3ZyYXhycHhrcWJkbXJvbWdiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzgzMDAzNjksImV4cCI6MjA1Mzg3NjM2OX0.mufI2t0cKNRuO6GosHIAFuaJbEjrpiY6hJmx9HD21Q0",{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}}),_=[32.7767,-96.797];function z(){const[s,a]=e.useState(""),[n,t]=e.useState(""),[o,r]=e.useState([]),[l,c]=e.useState(null),[d,m]=e.useState(_),[u,h]=e.useState([]),[p,g]=e.useState(!1),[x,j]=e.useState(13),[b,f]=e.useState(""),y=async(e,s)=>{try{const a=69,n=20/a,i=20/(a*Math.cos(e*Math.PI/180)),{data:o,error:l}=await U.from("businesses").select("*").gte("latitude",e-n).lte("latitude",e+n).gte("longitude",s-i).lte("longitude",s+i);if(l)throw l;if(!o)return r([]),void t("No businesses found in this area");const c=o.filter((a=>((e,s,a,n)=>{const t=e=>e*Math.PI/180,i=t(a-e),o=t(n-s),r=Math.sin(i/2)*Math.sin(i/2)+Math.cos(t(e))*Math.cos(t(a))*Math.sin(o/2)*Math.sin(o/2);return 2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r))*3959})(e,s,a.latitude,a.longitude)<=20)),[d,u]=((e,s)=>{const a=2*Math.random()*Math.PI,n=.5*Math.random();return[e+n/111*Math.cos(a),s+n/(111*Math.cos(e*Math.PI/180))*Math.sin(a)]})(e,s);r(c),c.length>0?(m([d,u]),j(11),t("")):(t("No businesses found within 20 miles of this location"),m([d,u]),j(10))}catch(a){t("Error loading businesses. Please try again."),r([])}finally{g(!1)}};e.useEffect((()=>{const e=()=>{(()=>{if(!("geolocation"in navigator))return void t("Your browser does not support location services. Please enter your location manually.");g(!0),t(""),r([]),navigator.geolocation.getCurrentPosition((async e=>{var s,n;i.event({category:"Location",action:"Find My Location Success"});const{latitude:o,longitude:r}=e.coords;try{const e=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${o}&lon=${r}&zoom=10`);if(!e.ok)throw new Error("Failed to get location name");const t=await e.json();a((null==(s=t.address)?void 0:s.city)||(null==(n=t.address)?void 0:n.town)||"your area"),await y(o,r)}catch(l){t("Error determining your location. Please try again or enter your location manually."),g(!1)}}),(e=>{i.event({category:"Error",action:"Location Error",label:`Code: ${e.code} - ${e.message}`});let s="Error getting your location. Please try entering it manually.";1===e.code?s="Location access was denied. Please allow location access or enter your location manually.":2===e.code?s="Unable to determine your location. Please try entering it manually.":3===e.code&&(s="Location request timed out. Please try again or enter your location manually."),t(s),g(!1)}),{enableHighAccuracy:!1,timeout:1e4,maximumAge:0})})()};return window.addEventListener("findMyLocation",e),()=>{window.removeEventListener("findMyLocation",e)}}),[]);const v=e=>{i.event({category:"Business",action:"View Business",label:e.name}),c(e)},N=e.useMemo((()=>{let e=o;return u.length>0&&(e=e.filter((e=>u.includes(e.category)))),e}),[o,u,b]);return w.jsxs(w.Fragment,{children:[w.jsxs("header",{className:"header",children:[w.jsx("h1",{children:"BlackEndpoints"}),w.jsx("p",{children:"Discover and support local Black-owned businesses in your area"})]}),w.jsxs("main",{className:"main",children:[w.jsx(F,{onSearch:async e=>{g(!0),t(""),r([]);try{if(!e.trim())return t("Please enter a location"),void g(!1);i.event({category:"Search",action:"Location Search",label:e});const s=/^\d{5}$/.test(e.trim()),n=s?`postalcode=${e}`:`q=${encodeURIComponent(e)}`,o=await fetch(`https://nominatim.openstreetmap.org/search?format=json&${n}&countrycodes=us`);if(!o.ok)throw new Error("Failed to search location");const r=await o.json();if(0===r.length)return t("Location not found. Please enter a valid US location or zip code."),void g(!1);const{lat:l,lon:c,display_name:d}=r[0];a(s?`area ${e}`:d.split(",")[0]),await y(parseFloat(l),parseFloat(c))}catch(s){i.event({category:"Error",action:"Search Error",label:s.message}),t("Error finding location. Please try again."),g(!1)}},onBusinessSearch:async e=>{g(!0),t(""),f(e.toLowerCase().trim());try{const{data:s,error:n}=await U.from("businesses").select("*").or(`name.ilike.%${e}%,category.ilike.%${e}%,description.ilike.%${e}%`);if(n)throw n;if(s&&0!==s.length){r(s);const e=s.reduce(((e,s)=>e+s.latitude),0)/s.length,n=s.reduce(((e,s)=>e+s.longitude),0)/s.length;m([e,n]),j(11),a("search results")}else t("No businesses found matching your search."),r([])}catch(s){t("Error searching businesses. Please try again."),r([])}finally{g(!1)}},error:n}),w.jsx(L,{onFilterChange:e=>{i.event({category:"Filter",action:"Category Filter",label:e.join(", ")}),h(e)}}),w.jsx(E,{center:d,zoom:x,businesses:N,onBusinessClick:v}),p?w.jsx("div",{className:"loading",children:"Loading businesses..."}):w.jsxs(w.Fragment,{children:[s&&w.jsx("h2",{className:"results-title",children:N.length>0?b?`Found ${N.length} business${1===N.length?"":"es"} matching "${b}"`:`Businesses near ${s}`:b?`No businesses found matching "${b}"`:`No businesses found near ${s}`}),w.jsx(P,{businesses:N,onBusinessClick:v})]}),l&&w.jsx(I,{business:l,onClose:()=>c(null)})]})]})}const B=e.memo((function(){const[s,a]=e.useState(!1),[n,t]=e.useState({name:"",location:"",phone:"",email:"",website:"",hours:"",category:"",description:"",imageUrl:""}),[i,o]=e.useState(!1),[r,l]=e.useState({}),c=e=>{const{name:s,value:a}=e.target;if("phone"!==s)t((e=>({...e,[s]:a})));else{const e=a.replace(/\D/g,"");if(e.length<=10){let a=e;return e.length>=3&&(a=`${e.slice(0,3)}-${e.slice(3)}`),e.length>=6&&(a=`${a.slice(0,7)}-${a.slice(7)}`),void t((e=>({...e,[s]:a})))}}};return w.jsxs(w.Fragment,{children:[w.jsx("button",{onClick:()=>a(!0),className:"add-business-btn","aria-label":"Add your business",children:"Add Your Business"}),s&&w.jsx("div",{className:"modal-overlay",onClick:()=>a(!1),role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",children:w.jsxs("div",{className:"modal-content add-business-modal",onClick:e=>e.stopPropagation(),children:[w.jsx("button",{className:"modal-close",onClick:()=>a(!1),"aria-label":"Close modal",children:"Ã—"}),w.jsxs("div",{className:"modal-details",children:[w.jsx("h2",{id:"modal-title",children:"Add Your Business"}),w.jsx("p",{className:"modal-subtitle",children:"List your business in our directory"}),w.jsxs("form",{onSubmit:e=>{e.preventDefault();const s=(()=>{const e={};return n.name.trim()||(e.name=!0),n.category||(e.category=!0),n.location.trim()||(e.location=!0),n.phone.trim()&&!/^\d{3}-\d{3}-\d{4}$/.test(n.phone)&&(e.phone=!0),n.email.trim()&&/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(n.email)||(e.email=!0),n.website&&!/^https?:\/\/.*/.test(n.website)&&(e.website=!0),n.imageUrl&&!/^https?:\/\/.*/.test(n.imageUrl)&&(e.imageUrl=!0),e})();if(l(s),o(!0),Object.keys(s).length>0)return;const i=new Date,r=i.toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}),c=i.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}),d=n.imageUrl.trim()||`https://placehold.co/600x400/cccccc/333333?text=${encodeURIComponent(n.name)}`,m=`\nName: ${n.name}\nCategory: ${n.category}\nDescription: ${n.description}\nLocation: ${n.location}\nPhone: ${n.phone}\nEmail: ${n.email}\nWebsite: ${n.website}\nHours: ${n.hours}\nImage URL: ${d}\n    `.trim(),u=`mailto:blackendpoints@gmail.com?subject=NEW BUSINESS REQUEST FOR ${n.name}!! ${r} ${c}&body=${encodeURIComponent(m)}`;window.location.href=u,t({name:"",location:"",phone:"",email:"",website:"",hours:"",category:"",description:"",imageUrl:""}),o(!1),a(!1)},className:"add-business-form",noValidate:!0,children:[w.jsxs("div",{className:"form-group",children:[w.jsx("label",{htmlFor:"name",children:"Business Name"}),w.jsx("input",{type:"text",id:"name",name:"name",value:n.name,onChange:c,className:i&&r.name?"error":"",required:!0,"aria-required":"true","aria-invalid":i&&r.name?"true":"false"})]}),w.jsxs("div",{className:"form-group",children:[w.jsx("label",{htmlFor:"category",children:"Category"}),w.jsxs("select",{id:"category",name:"category",value:n.category,onChange:c,className:i&&r.category?"error":"",required:!0,"aria-required":"true","aria-invalid":i&&r.category?"true":"false",children:[w.jsx("option",{value:"",children:"Select a category"}),["Food","Hair Care","Retail","Professional Services","Home Services","Technology"].map((e=>w.jsx("option",{value:e,children:e},e)))]})]}),w.jsxs("div",{className:"form-group",children:[w.jsx("label",{htmlFor:"location",children:"Location"}),w.jsx("input",{type:"text",id:"location",name:"location",value:n.location,onChange:c,placeholder:"Full address",className:i&&r.location?"error":"",required:!0,"aria-required":"true","aria-invalid":i&&r.location?"true":"false"})]}),w.jsxs("div",{className:"form-group",children:[w.jsx("label",{htmlFor:"phone",children:"Phone Number"}),w.jsx("input",{type:"tel",id:"phone",name:"phone",value:n.phone,onChange:c,placeholder:"000-000-0000",className:i&&r.phone?"error":"","aria-invalid":i&&r.phone?"true":"false"})]}),w.jsxs("div",{className:"form-group",children:[w.jsx("label",{htmlFor:"email",children:"Email"}),w.jsx("input",{type:"email",id:"email",name:"email",value:n.email,onChange:c,placeholder:"contact@business.com",className:i&&r.email?"error":"",required:!0,"aria-required":"true","aria-invalid":i&&r.email?"true":"false"})]}),w.jsxs("div",{className:"form-group",children:[w.jsx("label",{htmlFor:"website",children:"Website"}),w.jsx("input",{type:"url",id:"website",name:"website",value:n.website,onChange:c,placeholder:"https://example.com",className:i&&r.website?"error":"","aria-invalid":i&&r.website?"true":"false"})]}),w.jsxs("div",{className:"form-group",children:[w.jsx("label",{htmlFor:"hours",children:"Business Hours"}),w.jsx("input",{type:"text",id:"hours",name:"hours",value:n.hours,onChange:c,placeholder:"Mon-Fri: 9AM-5PM, Sat: 10AM-3PM"})]}),w.jsxs("div",{className:"form-group",children:[w.jsx("label",{htmlFor:"description",children:"Business Description"}),w.jsx("textarea",{id:"description",name:"description",value:n.description,onChange:c,placeholder:"Tell us about your business..."})]}),w.jsxs("div",{className:"form-group",children:[w.jsx("label",{htmlFor:"imageUrl",children:"Image URL"}),w.jsx("input",{type:"url",id:"imageUrl",name:"imageUrl",value:n.imageUrl,onChange:c,placeholder:"https://example.com/image.jpg",className:i&&r.imageUrl?"error":"","aria-invalid":i&&r.imageUrl?"true":"false"})]}),w.jsx("button",{type:"submit",className:"submit-button",children:"Submit Business"})]})]})]})})]})}));function R(){return w.jsx(a,{children:w.jsxs("div",{className:"app",children:[w.jsx("div",{className:"action-buttons",children:w.jsxs("div",{className:"action-buttons-container",children:[w.jsx("button",{onClick:()=>{const e=new CustomEvent("findMyLocation");window.dispatchEvent(e)},className:"find-location-btn",children:"Find My Location"}),w.jsx(B,{})]})}),w.jsx(n,{children:w.jsx(t,{path:"/*",element:w.jsx(z,{})})}),w.jsxs("div",{className:"copyright",children:["Â© ",(new Date).getFullYear()," ",w.jsx("a",{href:"https://www.instagram.com/blackendpoints",target:"_blank",rel:"noopener noreferrer",children:"BlackEndpoints"}),". Created by ",w.jsx("a",{href:"https://github.com/jcode116",target:"_blank",rel:"noopener noreferrer",children:"@jcode116"})]})]})})}i.initialize("G-XXXXXXXXXX"),"serviceWorker"in navigator&&window.addEventListener("load",(()=>{navigator.serviceWorker.register("/sw.js").then((e=>{})).catch((e=>{}))})),N(document.getElementById("root")).render(w.jsx(e.StrictMode,{children:w.jsx(R,{})}));
